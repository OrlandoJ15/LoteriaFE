import{t as se,j as e,r as s,N,I as T,M as ie,S as E,O as v,K as d,P as ne,Q as le,R as ce}from"./index-C9xMqd9z.js";import{M as U,k as de,j as K,I as m}from"./InputGeneral-Do5fAD7f.js";import{A as ue,E as me,D as pe}from"./Edit-B-lilJ91.js";const he=se(e.jsx("path",{d:"M22 7h-9v2h9zm0 8h-9v2h9zM5.54 11 2 7.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41zm0 8L2 15.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41z"}),"Checklist"),xe=[{title:"Codigo",field:"id"},{title:"Id Usuario",field:"idUsuario"},{title:"Usuario",field:"nombreUsuario"},{title:"Id Tipo De Sorteo",field:"idTipoSorteo"},{title:"Tipo De Sorteo",field:"nombreTipoSorteoGeneral"},{title:"Fecha",field:"fechaTipoSorteo"}],Se="https://loteriawebapimvp.azurewebsites.net/Sorteo/RecSorteo",be="https://loteriawebapimvp.azurewebsites.net/Sorteo/InsSorteo",Ie="https://loteriawebapimvp.azurewebsites.net/Sorteo/ModSorteo",fe="https://loteriawebapimvp.azurewebsites.net/Sorteo/DelSorteo",je="https://loteriawebapimvp.azurewebsites.net/Sorteo/RecSorteoXId",Ee="https://loteriawebapimvp.azurewebsites.net/Kardex/InsKardex",ye=()=>{const c={campo:"",valido:null},[a,p]=s.useState(c),[i,h]=s.useState(c),[n,x]=s.useState(c),[z,M]=s.useState(!1),[S,b]=s.useState([]),[P,L]=s.useState(!1),[k,O]=s.useState(!1),[A,Q]=s.useState(!1),u={Id:/^[0-9]*$/,IdUsuario:/^[0-9]*$/,IdTipoSorteo:/^[0-9]*$/},X=()=>{p(c),h(c),x(c)},V=r=>r.every(o=>o.valido==="true"),B=(r,o,t)=>{r.preventDefault(),V(t)?(M(!0),X(),o()):M(!1)},q=r=>B(r,Y,[a,i,n]),J=r=>B(r,H,[a,i,n]),F=async()=>{const r={id:a.campo,idUsuario:0,idTipoSorteo:0};try{if((await d.post(je,r)).data===null)return;p({campo:"",valido:"false"}),E.fire({icon:"error",title:"Cuidado",text:"Código De Sorteo Existente, Intente Nuevamente"})}catch(o){console.error("Error:",o)}},Y=()=>D("Desea Guardar Los Cambios?",Z),H=()=>D("Desea Editar Los Cambios?",_),W=()=>D("Desea Eliminar Los Cambios?",ee),D=(r,o)=>{E.fire({title:r,showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed?(E.fire("Operacion Exitosa","","success"),o()):t.isDenied&&E.fire("Cambios No Guardados","","info")})},g=async r=>{const o={Serie:r,Numero:Numero.campo,Nombre:Nombre.campo,Monto:Monto.campo,Id:a.campo};try{const t=await d.post(Ee,o)}catch(t){console.error("Error en la peticion Post del Kardex: ",t)}},Z=async()=>{const r=v();if(!r)return;const o={Id:a.campo,IdUsuario:i.campo,IdTipoSorteo:n.campo};try{const t=await d.post(be,o,{headers:{Authorization:`Bearer ${r}`}});b([...S,t.data]),g("Ins"),I()}catch(t){console.error("Error en la peticion Post: ",t)}},_=async()=>{const r=v();if(!r)return;const o={id:a.campo,idUsuario:i.campo,idTipoSorteo:n.campo};try{const t=await d.put(Ie,o,{headers:{Authorization:`Bearer ${r}`}}),l=S.map($=>$.id===o.id?o:$);b(l),g("Mod"),f()}catch(t){console.error("Error En La Peticion Put: ",t)}},ee=async()=>{const r=v();if(!r)return;const o=a.campo,t={headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},data:JSON.stringify(o)};try{await d.delete(fe,t),b(S.filter(l=>l.id!==o.campo)),g("Del"),j(),R()}catch(l){console.error("Error Al Eliminar El Sorteo: ",l)}},y=async(r,o)=>{const t=Object.values(...r);p({campo:t[0],valido:"true"}),h({campo:t[1],valido:"true"}),x({campo:t[2],valido:"true"}),o==="Editar"?f():j()},R=async()=>{const r=v();if(r)try{const o=await d.get(Se,{headers:{Authorization:`Bearer ${r}`}});b(o.data)}catch{console.error("Error Al Obtener Los Sorteos",error)}};s.useEffect(()=>{R()},[]);const I=()=>{L(!P)},f=()=>{O(!k)},j=()=>{Q(!A)},C={width:"70%",height:"100%",overflowX:"hidden",overflowY:"scroll",position:"relative",inset:"0",backgroundColor:"rgba(0, 0, 0, 0.5)"},G={position:"fixed",top:"50%",left:"50%",width:"100%",height:"100%",transform:"translate(-50%, -50%)",zIndex:1040,padding:"0 0 0 25%"},oe={position:"fixed",top:"50%",left:"50%",width:"100%",height:"100%",transform:"translate(-50%, -50%)",zIndex:1040,padding:"0 0 0 25%"},w=({titulo:r,formularioValido:o,onCancel:t,onSubmit:l})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container-footer",children:[o===!1&&e.jsx(ne,{children:e.jsxs("p",{children:[e.jsx(le,{icon:de}),e.jsx("b",{children:"Error:"})," Por favor rellena el formulario correctamente."]})}),o===!0&&e.jsx(ce,{children:"Campos llenos exitosamente!"}),e.jsxs("div",{align:"right",children:[e.jsx(K,{className:"btn-cancelar",onClick:t,children:"Cancelar"}),e.jsx(K,{class:"btn-agregar",onClick:l,type:"submit",children:r})]})]})}),re=e.jsxs("div",{style:C,children:[e.jsx("h3",{className:"container-header",children:" 301 - Agregar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:[" ","General",e.jsx("div",{className:"container-fluid",children:e.jsx(N,{children:e.jsxs(T,{children:[e.jsx(m,{estado:a,cambiarEstado:p,tipo:"text",label:"Id Del Sorteo",placeholder:"Introduzca El Id Del Sorteo",name:"Id",leyendaError:"El Id Del Sorteo Solo Puede Contener Numeros.",expresionRegular:u.Id,onChange:F,onBlur:F,autofocus:!0}),e.jsx(m,{estado:i,cambiarEstado:h,tipo:"text",label:"Id Del Usuario",placeholder:"Introduzca El Id Del Usuario",name:"IdUsuario",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdUsuario}),e.jsx(m,{estado:n,cambiarEstado:x,tipo:"text",label:"Id Del Tipo De Sorteo",placeholder:"Introduzca El Id Del Tipo De Sorteo",name:"IdTipoSorteo",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdTipoSorteo})]})})})]}),e.jsx(w,{titulo:"Insertar",formularioValido:z,onCancel:I,onSubmit:q})]}),te=e.jsxs("div",{style:C,children:[e.jsx("h3",{className:"container-header",children:" 302 - Modificar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:["General",e.jsx("div",{className:"container-fluid",children:e.jsx(N,{children:e.jsxs(T,{children:[e.jsx(m,{estado:i,cambiarEstado:h,tipo:"text",label:"Id Del Usuario",placeholder:"Introduzca El Id Del Usuario",name:"IdUsuario",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdUsuario}),e.jsx(m,{estado:n,cambiarEstado:x,tipo:"text",label:"Id Del Tipo De Sorteo",placeholder:"Introduzca El Id Del Tipo De Sorteo",name:"IdTipoSorteo",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdTipoSorteo})]})})})]}),e.jsx(w,{titulo:"Editar",formularioValido:z,onCancel:f,onSubmit:J})]}),ae=e.jsxs("div",{style:C,children:[e.jsx("h3",{className:"container-header",children:" 303 - Eliminar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:[" ","General",e.jsx("div",{className:"container-fluid",children:e.jsx(N,{children:e.jsxs(T,{children:[e.jsxs("h4",{children:["Codigo: ",a.campo]}),e.jsxs("h4",{children:["Usuario: ",i.campo]}),e.jsxs("h4",{children:["Tipo De Sorteo: ",n.campo]})]})})})]}),e.jsx(w,{titulo:"Eliminar",onCancel:j,onSubmit:W})]});return e.jsxs("div",{className:"Cliente",children:[e.jsx("div",{className:"banner",children:e.jsx("h3",{children:"300-Mantenimiento De Sorteos"})}),e.jsx("div",{children:e.jsx("button",{className:"btn-añadir",startIcon:e.jsx(ue,{}),onClick:()=>I(),children:"Agregar Sorteo"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(ie,{columns:xe,data:S,title:"Sorteos",actions:[{icon:me,tooltip:"Modificar",onClick:(r,o)=>y(o,"Editar")},{icon:pe,tooltip:"Eliminar",onClick:(r,o)=>y(o,"Eliminar")},{icon:he,tooltip:"Detalles",onClick:(r,o)=>y(o,"Detalles")}],options:{actionsColumnIndex:-1,exportButton:!0,columnsButton:!0,headerStyle:{backgroundColor:"lightgrey"},selection:!0,showTextRowSelected:!1,showSelectedAllheckbox:!1,searchFieldAligment:"left",showtitle:!1},localization:{header:{actions:"Acciones"},toolbar:{searchPlaceholder:"Busqueda"}}}),e.jsx(U,{open:P,onClose:I,style:G,children:e.jsx(e.Fragment,{children:re})}),e.jsx(U,{open:k,onClose:f,style:G,children:e.jsx(e.Fragment,{children:te})}),e.jsx(U,{open:A,onClose:j,style:oe,children:e.jsx(e.Fragment,{children:ae})})]})};export{ye as default};
