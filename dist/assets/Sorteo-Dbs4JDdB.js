import{q as te,j as e,r as s,a8 as U,a4 as N,a6 as ae,a9 as b,aa as D,a7 as d,ab as se,ac as ie,ad as ne}from"./index-i6cV1Y3u.js";import{A as le,E as ce,D as de,f as ue,I as m}from"./InputGeneral-CaHIVkyX.js";import{n as w,M}from"./Modal-y4NBJ25E.js";const me=te(e.jsx("path",{d:"M22 7h-9v2h9zm0 8h-9v2h9zM5.54 11 2 7.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41zm0 8L2 15.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41z"}),"Checklist"),pe=[{title:"Codigo",field:"id"},{title:"Id Usuario",field:"idUsuario"},{title:"Usuario",field:"nombreUsuario"},{title:"Id Tipo De Sorteo",field:"idTipoSorteo"},{title:"Tipo De Sorteo",field:"nombreTipoSorteoGeneral"},{title:"Fecha",field:"fechaTipoSorteo"}],he="https://localhost:44366/Sorteo/RecSorteo",xe="https://localhost:44366/Sorteo/InsSorteo",Se="https://localhost:44366/Sorteo/ModSorteo",Ie="https://localhost:44366/Sorteo/DelSorteo",je="https://localhost:44366/Sorteo/RecSorteoXId",Ee="https://localhost:44366/Kardex/InsKardex",Ce=()=>{const c={campo:"",valido:null},[a,p]=s.useState(c),[i,h]=s.useState(c),[n,x]=s.useState(c),[P,k]=s.useState(!1),[S,I]=s.useState([]),[z,L]=s.useState(!1),[B,K]=s.useState(!1),[A,O]=s.useState(!1),u={Id:/^[0-9]*$/,IdUsuario:/^[0-9]*$/,IdTipoSorteo:/^[0-9]*$/},Q=()=>{p(c),h(c),x(c)},X=r=>r.every(o=>o.valido==="true"),F=(r,o,t)=>{r.preventDefault(),X(t)?(k(!0),Q(),o()):k(!1)},V=r=>F(r,J,[a,i,n]),q=r=>F(r,Y,[a,i,n]),R=async()=>{const r={id:a.campo,idUsuario:0,idTipoSorteo:0};try{if((await d.post(je,r)).data===null)return;p({campo:"",valido:"false"}),b.fire({icon:"error",title:"Cuidado",text:"CÃ³digo De Sorteo Existente, Intente Nuevamente"})}catch(o){console.error("Error:",o)}},J=()=>C("Desea Guardar Los Cambios?",W),Y=()=>C("Desea Editar Los Cambios?",Z),H=()=>C("Desea Eliminar Los Cambios?",_),C=(r,o)=>{b.fire({title:r,showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed?(b.fire("Operacion Exitosa","","success"),o()):t.isDenied&&b.fire("Cambios No Guardados","","info")})},v=async r=>{const o={Serie:r,Numero:Numero.campo,Nombre:Nombre.campo,Monto:Monto.campo,Id:a.campo};try{const t=await d.post(Ee,o)}catch(t){console.error("Error en la peticion Post del Kardex: ",t)}},W=async()=>{const r=D();if(!r)return;const o={Id:a.campo,IdUsuario:i.campo,IdTipoSorteo:n.campo};try{const t=await d.post(xe,o,{headers:{Authorization:`Bearer ${r}`}});I([...S,t.data]),v("Ins"),j()}catch(t){console.error("Error en la peticion Post: ",t)}},Z=async()=>{const r=D();if(!r)return;const o={id:a.campo,idUsuario:i.campo,idTipoSorteo:n.campo};try{const t=await d.put(Se,o,{headers:{Authorization:`Bearer ${r}`}}),l=S.map($=>$.id===o.id?o:$);I(l),v("Mod"),E()}catch(t){console.error("Error En La Peticion Put: ",t)}},_=async()=>{const r=D();if(!r)return;const o=a.campo,t={headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},data:JSON.stringify(o)};try{await d.delete(Ie,t),I(S.filter(l=>l.id!==o.campo)),v("Del"),f(),G()}catch(l){console.error("Error Al Eliminar El Sorteo: ",l)}},g=async(r,o)=>{const t=Object.values(...r);p({campo:t[0],valido:"true"}),h({campo:t[1],valido:"true"}),x({campo:t[2],valido:"true"}),o==="Editar"?E():f()},G=async()=>{const r=D();if(r)try{const o=await d.get(he,{headers:{Authorization:`Bearer ${r}`}});I(o.data)}catch{console.error("Error Al Obtener Los Sorteos",error)}};s.useEffect(()=>{G()},[]);const j=()=>{L(!z)},E=()=>{K(!B)},f=()=>{O(!A)},y={width:"70%",height:"100%",overflowX:"hidden",overflowY:"scroll",position:"relative",backgroundColor:"rgb(255, 255, 255)"},T=({titulo:r,formularioValido:o,onCancel:t,onSubmit:l})=>e.jsxs(e.Fragment,{children:[o===!1&&e.jsx(se,{children:e.jsxs("p",{children:[e.jsx(ie,{icon:ue}),e.jsx("b",{children:"Error:"})," Por favor rellena el formulario correctamente."]})}),o===!0&&e.jsx(ne,{children:"Campos llenos exitosamente!"}),e.jsxs("div",{align:"right",children:[e.jsx(w,{color:"success",onClick:t,children:"Cancelar"}),e.jsx(w,{color:"primary",onClick:l,type:"submit",children:r})]})]}),ee=e.jsxs("div",{style:y,children:[e.jsx("h3",{children:"Insertar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:[" ","General",e.jsx("div",{className:"container-fluid",children:e.jsx(U,{children:e.jsxs(N,{children:[e.jsx(m,{estado:a,cambiarEstado:p,tipo:"text",label:"Id Del Sorteo",placeholder:"Introduzca El Id Del Sorteo",name:"Id",leyendaError:"El Id Del Sorteo Solo Puede Contener Numeros.",expresionRegular:u.Id,onChange:R,onBlur:R,autofocus:!0}),e.jsx(m,{estado:i,cambiarEstado:h,tipo:"text",label:"Id Del Usuario",placeholder:"Introduzca El Id Del Usuario",name:"IdUsuario",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdUsuario}),e.jsx(m,{estado:n,cambiarEstado:x,tipo:"text",label:"Id Del Tipo De Sorteo",placeholder:"Introduzca El Id Del Tipo De Sorteo",name:"IdTipoSorteo",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdTipoSorteo})]})})})]}),e.jsx(T,{titulo:"Insertar",formularioValido:P,onCancel:j,onSubmit:V})]}),oe=e.jsxs("div",{style:y,children:[e.jsx("h3",{children:"Editar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:["General",e.jsx("div",{className:"container-fluid",children:e.jsx(U,{children:e.jsxs(N,{children:[e.jsx(m,{estado:i,cambiarEstado:h,tipo:"text",label:"Id Del Usuario",placeholder:"Introduzca El Id Del Usuario",name:"IdUsuario",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdUsuario}),e.jsx(m,{estado:n,cambiarEstado:x,tipo:"text",label:"Id Del Tipo De Sorteo",placeholder:"Introduzca El Id Del Tipo De Sorteo",name:"IdTipoSorteo",leyendaError:"El Id Debe Ser Numeros entro 0-9",expresionRegular:u.IdTipoSorteo})]})})})]}),e.jsx(T,{titulo:"Editar",formularioValido:P,onCancel:E,onSubmit:q})]}),re=e.jsxs("div",{style:y,children:[e.jsx("h3",{children:"Eliminar Sorteo"}),e.jsxs("div",{className:"relleno-general",children:[" ","General",e.jsx("div",{className:"container-fluid",children:e.jsx(U,{children:e.jsxs(N,{children:[e.jsxs("h4",{children:["Codigo: ",a.campo]}),e.jsxs("h4",{children:["Usuario: ",i.campo]}),e.jsxs("h4",{children:["Tipo De Sorteo: ",n.campo]})]})})})]}),e.jsx(T,{titulo:"Eliminar",onCancel:f,onSubmit:H})]});return e.jsxs("div",{className:"Cliente",children:[e.jsx("div",{className:"banner",children:e.jsx("h3",{children:e.jsx("b",{children:"200-Mantenimiento De Sorteos"})})}),e.jsx("div",{className:"btn-agrega",children:e.jsx(w,{startIcon:e.jsx(le,{}),onClick:()=>j(),children:"Agregar Sorteo"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(ae,{columns:pe,data:S,title:"Sorteos",actions:[{icon:ce,tooltip:"Modificar",onClick:(r,o)=>g(o,"Editar")},{icon:de,tooltip:"Eliminar",onClick:(r,o)=>g(o,"Eliminar")},{icon:me,tooltip:"Detalles",onClick:(r,o)=>g(o,"Detalles")}],options:{actionsColumnIndex:-1,exportButton:!0,columnsButton:!0,headerStyle:{backgroundColor:"lightgrey"},selection:!0,showTextRowSelected:!1,showSelectedAllheckbox:!1,searchFieldAligment:"left",showtitle:!1},localization:{header:{actions:"Acciones"},toolbar:{searchPlaceholder:"Busqueda"}}}),e.jsx(M,{open:z,onClose:j,children:e.jsx(e.Fragment,{children:ee})}),e.jsx(M,{open:B,onClose:E,children:e.jsx(e.Fragment,{children:oe})}),e.jsx(M,{open:A,onClose:f,children:e.jsx(e.Fragment,{children:re})})]})};export{Ce as default};
